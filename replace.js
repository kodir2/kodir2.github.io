(function(g,q){function u(){if(window.COLLAPS_CONF)if(COLLAPS_CONF.length)for(var a=0;a<COLLAPS_CONF.length;a++)v(COLLAPS_CONF[a]);else v(COLLAPS_CONF);else x(g+"/autochange/settings/domain/","settings",v)}function v(a){if(!a.dom_id&&!a.replaces.length)return l("set dom_id or replaces");(new Image).src="https://stats.myangular.life/player?hit=script&sub=replace&host="+location.hostname;if(a.src)D(a);else if(a.movie){var c=y(g+"/embed/movie/"+a.movie,a.frame_params);n(c,a,a.width,a.height);return}var b=
a.kinopoisk_var;if(b=a.kinopoisk_id||b&&window[b])w(g+"/autochange/info/kinopoisk?id="+b,"kp "+b,a);else if(a.title)c=g+"/autochange/info/link?title="+a.title.toLowerCase()+z(a,"year","charset","separator","season","episode"),w(c,a.title,a);else{b=document.title||document.getElementsByTagName("title")[0].innerHTML;b=b.replace(/ /g," ");var d;for(d in a.templates){var e=a.templates[d];if(c=b.match(new RegExp(e.regexp,"i"))){var f=e.order;break}}c?(d=c[f[0]].toLowerCase())?(c=g+"/autochange/info/link?title="+
d+z({year:c[f[1]],season:c[f[2]],episode:c[f[3]]},"year","season","episode")+"&separator="+a.separator+"&charset="+a.charset,w(c,d,a)):l("no title"):l("templates isn't match")}}function D(a){var c=a.src;window.URL&&(c=new URL(c),c.hostname=(new URL(g)).hostname);n(c,a,a.width,a.height);removeEventListener("message",a.messageListener);a.messageListener=function(b){b.origin==location.origin&&"reActualizeMe"==b.data&&(window.URL&&c.searchParams["delete"]("episode"),n(c,a,a.width,a.height))};addEventListener("message",
a.messageListener)}function x(a,c,b,d){var e=new XMLHttpRequest;e.open("GET",a);e.onreadystatechange=function(){if(4===e.readyState)if(204===e.status)l(c+" not found"),d&&"function"==typeof d&&d();else{if(200!==e.status)return l("api request failed");b(JSON.parse(e.response))}};e.send()}function z(a){for(var c="",b,d=1;d<arguments.length;d++)b=arguments[d],a[b]&&(c+="&"+b+"="+a[b]);return c}function w(a,c,b){x(a,c,function(d){d=y(d.url,b.frame_params);n(d,b,b.width,b.height);A(b.replaces||[],d)},
b.not_found_cb)}function y(a,c){if(!c)return a;var b=c.join("&"),d=~a.indexOf("?")?"&":"?";return b?a+d+b:a}function n(a,c,b,d){if(c.dom_id){var e=c.dom_id,f=document.getElementById(e);if(!f)return setTimeout(n.bind(null,a,c,b,d),50);c._lastInserts=c._lastInserts||{};c._lastInserts[e]=a;var m="",r="";b&&"0"!==b&&(m=' width="'+b+'"');d&&"0"!==d&&(r=' height="'+d+'"');var t=m+r+' allowfullscreen allow="autoplay *; fullscreen" frameborder="0" webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>';
g==q?f.innerHTML='<iframe src="'+a+'"'+t:B(a,function(h){if(c._lastInserts[e]==a){f.innerHTML="<iframe "+t;var k=f.getElementsByTagName("iframe")[0];k.contentDocument.write(h);k.contentDocument.close()}},c.error_cb)}}function A(a,c){if(a.length){for(var b=document.getElementsByTagName("iframe"),d=0;d<b.length;d++){var e=b[d],f=e.src.match(/https?:\/\/(.+?)\/.+/);f&&E(f[1],a)&&(e.src=c,C(e),g!=q&&B(c,function(m,r){return function(t){for(var h=document.createElement("iframe"),k=m.attributes,p=0;p<k.length;p++)"src"!==
k[p].name&&h.setAttribute(k[p].name,k[p].value);m.parentElement.replaceChild(h,m);C(h);h.contentDocument.write(t);h.contentDocument.close();l(r+" replaced")}}(e,f[1])))}setTimeout(A.bind(null,a,c),100)}}function E(a,c){for(var b,d=a.length,e=0;e<c.length;e++)if(b=c[e],b==a||"."==b[0]&&b===a.substring(d-b.length,d))return!0}function B(a,c,b){var d=new XMLHttpRequest;d.open("GET",a);d.withCredentials=!0;d.onreadystatechange=function(){4===d.readyState&&(200===d.status||404===d.status&&d.response&&~d.response.indexOf("\u0412\u0438\u0434\u0435\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e")?
c(d.response):b&&"function"==typeof b&&b(d.response,d.status))};d.send()}function C(a){a.hasAttribute("allowfullscreen")&&(a.allowFullscreen=!0);a.setAttribute("allow","autoplay *; fullsreen");a.allow="autoplay *; fullsreen"}var l=console.log.bind(console,"[collaps]");~navigator.userAgent.indexOf("iPhone")&&window.fetch&&"https:"===location.protocol?fetch(q+"/ping/",{method:"head"}).then(function(){g=q;u()})["catch"](u):u()})("https://api.kinogram.best","https://api.synchroncode.com");